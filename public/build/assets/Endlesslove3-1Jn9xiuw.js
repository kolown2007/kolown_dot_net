import{S as H,a as N,s as O,e as _,b as T,d,o as y,f as p,g,A as h,B as k,C as j,j as m,p as B,v as b,E as L,y as F,F as w,l as G,G as I,H as J}from"./app-DWYraVgU.js";import{a as P}from"./ably-CEw0Ge6q.js";import{f as R}from"./index-ChWuH1nm.js";function S(i,e,t){const o=i.slice();return o[8]=e[t],o[10]=t,o}function C(i){let e,t=[],o=new Map,n,s=b(i[2]);const a=l=>l[8].id;for(let l=0;l<s.length;l+=1){let r=S(i,s,l),u=a(r);o.set(u,t[l]=E(u,r))}return{c(){e=_("div");for(let l=0;l<t.length;l+=1)t[l].c();d(e,"class","grid grid-cols-3 gap-10 px-10 py-10")},m(l,r){p(l,e,r);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);n=!0},p(l,r){r&12&&(s=b(l[2]),L(),t=F(t,r,a,1,l,s,o,e,J,E,null,S),j())},i(l){if(!n){for(let r=0;r<s.length;r+=1)h(t[r]);n=!0}},o(l){for(let r=0;r<t.length;r+=1)k(t[r]);n=!1},d(l){l&&m(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}function E(i,e){let t,o,n,s,a,l,r,u;function v(){return e[4](e[10])}return{key:i,first:null,c(){t=_("div"),o=_("img"),s=T(),w(o.src,n=e[8].url)||d(o,"src",n),d(o,"alt","Image"),d(o,"class","w-16"),this.first=t},m(c,f){p(c,t,f),g(t,o),g(t,s),l=!0,r||(u=G(o,"click",v),r=!0)},p(c,f){e=c,(!l||f&4&&!w(o.src,n=e[8].url))&&d(o,"src",n)},i(c){l||(a&&a.end(1),l=!0)},o(c){c&&(a=I(t,R,{y:-200,duration:500})),l=!1},d(c){c&&m(t),c&&a&&a.end(),r=!1,u()}}}function M(i){let e;return{c(){e=_("div"),e.innerHTML="",d(e,"class","full-screen-bg svelte-98ktne")},m(t,o){p(t,e,o)},d(t){t&&m(e)}}}function U(i){let e,t,o,n=i[0]&&C(i),s=!i[0]&&M();return{c(){e=_("main"),n&&n.c(),t=T(),s&&s.c(),d(e,"class","relative w-screen h-screen overflow-hidden flex justify-center items-center"),y(e,"background-color",i[1])},m(a,l){p(a,e,l),n&&n.m(e,null),g(e,t),s&&s.m(e,null),o=!0},p(a,[l]){a[0]?n?(n.p(a,l),l&1&&h(n,1)):(n=C(a),n.c(),h(n,1),n.m(e,t)):n&&(L(),k(n,1,1,()=>{n=null}),j()),a[0]?s&&(s.d(1),s=null):s||(s=M(),s.c(),s.m(e,null)),(!o||l&2)&&y(e,"background-color",a[1])},i(a){o||(h(n),o=!0)},o(a){k(n),o=!1},d(a){a&&m(e),n&&n.d(),s&&s.d()}}}async function z(){try{const i=await fetch("/api/updatelove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!i.ok)throw new Error("Network response was not ok");const e=await i.json();console.log("Love count updated:",e)}catch(i){console.error("Error updating love count:",i)}}function D(i,e,t){let o,n=0,s="#080101",a,l;B(()=>{a=new P.Realtime({authUrl:"/ablyauth"}),a.connection.once("connected",()=>{alert("tap the heart"),l=a.channels.get("get-started")}),t(0,o=!0)});let r=Array(10).fill(null).map((c,f)=>({id:f,url:"https://kolown.net/assets/gitm/heart.svg"}));async function u(c){n+=1,console.log("click:"+n),l.publish("endless","love");let f=["state1","state2","state3","state4","state5"],q=f[Math.floor(Math.random()*f.length)];n===10&&(l.publish("state",q),setTimeout(()=>{a.connection.close(),z(),t(1,s="#080101")},100)),t(2,r=r.filter((K,A)=>A!==c)),r.length===0&&t(0,o=!1)}return[o,s,r,u,c=>u(c)]}class X extends H{constructor(e){super(),N(this,e,D,U,O,{})}}export{X as default};
