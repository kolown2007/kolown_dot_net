import{k as S,S as H,i as N,s as V,e as p,a as q,b as d,m as C,c as g,d as v,t as m,o as b,p as L,g as k,q as z,u as T,v as O,w as A,x as M,l as J,y as P,z as R}from"./app-D9GZi101.js";import{a as B}from"./ably-CksMIMjX.js";function D(i){const e=i-1;return e*e*e+1}function F(i,{delay:e=0,duration:t=400,easing:s=D,x:l=0,y:a=0,opacity:r=0}={}){const n=getComputedStyle(i),o=+n.opacity,u=n.transform==="none"?"":n.transform,_=o*(1-r),[c,f]=S(l),[y,w]=S(a);return{delay:e,duration:t,easing:s,css:(h,U)=>`
			transform: ${u} translate(${(1-h)*c}${f}, ${(1-h)*y}${w});
			opacity: ${o-_*U}`}}function x(i,e,t){const s=i.slice();return s[8]=e[t],s[10]=t,s}function E(i){let e,t=[],s=new Map,l,a=T(i[2]);const r=n=>n[8].id;for(let n=0;n<a.length;n+=1){let o=x(i,a,n),u=r(o);s.set(u,t[n]=$(u,o))}return{c(){e=p("div");for(let n=0;n<t.length;n+=1)t[n].c();d(e,"class","grid grid-cols-3 gap-10 px-10 py-10")},m(n,o){g(n,e,o);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);l=!0},p(n,o){o&12&&(a=T(n[2]),O(),t=A(t,o,r,1,n,a,s,e,R,$,null,x),L())},i(n){if(!l){for(let o=0;o<a.length;o+=1)m(t[o]);l=!0}},o(n){for(let o=0;o<t.length;o+=1)b(t[o]);l=!1},d(n){n&&k(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}function $(i,e){let t,s,l,a,r,n,o,u;function _(){return e[4](e[10])}return{key:i,first:null,c(){t=p("div"),s=p("img"),a=q(),M(s.src,l=e[8].url)||d(s,"src",l),d(s,"alt","Heart"),d(s,"class","w-16"),this.first=t},m(c,f){g(c,t,f),v(t,s),v(t,a),n=!0,o||(u=J(s,"click",_),o=!0)},p(c,f){e=c,(!n||f&4&&!M(s.src,l=e[8].url))&&d(s,"src",l)},i(c){n||(r&&r.end(1),n=!0)},o(c){c&&(r=P(t,F,{y:-200,duration:500})),n=!1},d(c){c&&k(t),c&&r&&r.end(),o=!1,u()}}}function j(i){let e;return{c(){e=p("div"),e.innerHTML='<div class="fixed bottom-3 text-center text-white font-mono"><p class="text-4xl">Thank you for participating.</p></div>',d(e,"class","full-screen-bg svelte-17swels")},m(t,s){g(t,e,s)},d(t){t&&k(e)}}}function G(i){let e,t,s,l=i[0]&&E(i),a=!i[0]&&j();return{c(){e=p("main"),l&&l.c(),t=q(),a&&a.c(),d(e,"class","relative w-screen h-screen overflow-hidden flex justify-center items-center"),C(e,"background-color",i[1])},m(r,n){g(r,e,n),l&&l.m(e,null),v(e,t),a&&a.m(e,null),s=!0},p(r,[n]){r[0]?l?(l.p(r,n),n&1&&m(l,1)):(l=E(r),l.c(),m(l,1),l.m(e,t)):l&&(O(),b(l,1,1,()=>{l=null}),L()),r[0]?a&&(a.d(1),a=null):a||(a=j(),a.c(),a.m(e,null)),(!s||n&2)&&C(e,"background-color",r[1])},i(r){s||(m(l),s=!0)},o(r){b(l),s=!1},d(r){r&&k(e),l&&l.d(),a&&a.d()}}}async function I(){try{const i=await fetch("/api/updatelove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!i.ok)throw new Error("Network response was not ok");const e=await i.json();console.log("Love count updated:",e)}catch(i){console.error("Error updating love count:",i)}}function K(i,e,t){let s=!0,l=0,a="#080101",r,n;z(()=>{r=new B.Realtime({authUrl:"/ablyauth"}),r.connection.once("connected",()=>{n=r.channels.get("get-started")}),r.connection.on("failed",c=>{console.error("Connection failed:",c)}),t(0,s=!0)});let o=Array(10).fill(null).map((c,f)=>({id:f,url:"https://kolown.net/assets/gitm/heart.svg"}));async function u(c){l+=1,console.log("click:"+l),n.publish("endless","love");let f=["state1","state2","state3","state4","state5"],y=f[Math.floor(Math.random()*f.length)];t(2,o=o.filter((w,h)=>h!==c)),o.length===0&&(t(0,s=!1),n.publish("state",y),setTimeout(()=>{r.connection.close(),I(),t(1,a="#080101")},100))}return[s,a,o,u,c=>u(c)]}class X extends H{constructor(e){super(),N(this,e,K,G,V,{})}}export{X as default};
