import{k as w,S as H,i as N,s as V,e as p,a as q,b as d,m as C,c as m,d as y,t as h,o as v,p as L,g,q as z,u as T,v as M,w as A,x as S,l as J,y as P,z as R}from"./app-B3vrFLSW.js";import{a as B}from"./ably-C56UFuyG.js";function D(a){const e=a-1;return e*e*e+1}function F(a,{delay:e=0,duration:t=400,easing:r=D,x:o=0,y:i=0,opacity:s=0}={}){const n=getComputedStyle(a),l=+n.opacity,u=n.transform==="none"?"":n.transform,_=l*(1-s),[c,f]=w(o),[k,O]=w(i);return{delay:e,duration:t,easing:r,css:(b,U)=>`
			transform: ${u} translate(${(1-b)*c}${f}, ${(1-b)*k}${O});
			opacity: ${l-_*U}`}}function x(a,e,t){const r=a.slice();return r[8]=e[t],r[10]=t,r}function E(a){let e,t=[],r=new Map,o,i=T(a[2]);const s=n=>n[8].id;for(let n=0;n<i.length;n+=1){let l=x(a,i,n),u=s(l);r.set(u,t[n]=$(u,l))}return{c(){e=p("div");for(let n=0;n<t.length;n+=1)t[n].c();d(e,"class","grid grid-cols-3 gap-10 px-10 py-10")},m(n,l){m(n,e,l);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);o=!0},p(n,l){l&12&&(i=T(n[2]),M(),t=A(t,l,s,1,n,i,r,e,R,$,null,x),L())},i(n){if(!o){for(let l=0;l<i.length;l+=1)h(t[l]);o=!0}},o(n){for(let l=0;l<t.length;l+=1)v(t[l]);o=!1},d(n){n&&g(e);for(let l=0;l<t.length;l+=1)t[l].d()}}}function $(a,e){let t,r,o,i,s,n,l,u;function _(){return e[4](e[10])}return{key:a,first:null,c(){t=p("div"),r=p("img"),i=q(),S(r.src,o=e[8].url)||d(r,"src",o),d(r,"alt","Heart"),d(r,"class","w-16"),this.first=t},m(c,f){m(c,t,f),y(t,r),y(t,i),n=!0,l||(u=J(r,"click",_),l=!0)},p(c,f){e=c,(!n||f&4&&!S(r.src,o=e[8].url))&&d(r,"src",o)},i(c){n||(s&&s.end(1),n=!0)},o(c){c&&(s=P(t,F,{y:-200,duration:500})),n=!1},d(c){c&&g(t),c&&s&&s.end(),l=!1,u()}}}function j(a){let e;return{c(){e=p("div"),e.innerHTML='<div class="fixed bottom-3 text-center text-white font-mono"><p class="text-4xl">Thank you for participating.</p></div>',d(e,"class","full-screen-bg svelte-17swels")},m(t,r){m(t,e,r)},d(t){t&&g(e)}}}function G(a){let e,t,r,o=a[0]&&E(a),i=!a[0]&&j();return{c(){e=p("main"),o&&o.c(),t=q(),i&&i.c(),d(e,"class","relative w-screen h-screen overflow-hidden flex justify-center items-center"),C(e,"background-color",a[1])},m(s,n){m(s,e,n),o&&o.m(e,null),y(e,t),i&&i.m(e,null),r=!0},p(s,[n]){s[0]?o?(o.p(s,n),n&1&&h(o,1)):(o=E(s),o.c(),h(o,1),o.m(e,t)):o&&(M(),v(o,1,1,()=>{o=null}),L()),s[0]?i&&(i.d(1),i=null):i||(i=j(),i.c(),i.m(e,null)),(!r||n&2)&&C(e,"background-color",s[1])},i(s){r||(h(o),r=!0)},o(s){v(o),r=!1},d(s){s&&g(e),o&&o.d(),i&&i.d()}}}async function I(){try{const a=await fetch("/api/updatelove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok)throw new Error("Network response was not ok");const e=await a.json();console.log("Love count updated:",e)}catch(a){console.error("Error updating love count:",a)}}function K(a,e,t){let r=!0,o=0,i="#080101",s,n;z(()=>{s=new B.Realtime({authUrl:"/ablyauth"}),s.connection.once("connected",()=>{n=s.channels.get("get-started"),fetch("/api/kolown_bot")}),s.connection.on("failed",c=>{console.error("Connection failed:",c)}),t(0,r=!0)});let l=Array(10).fill(null).map((c,f)=>({id:f,url:"https://kolown.net/assets/gitm/heart.svg"}));async function u(c){o+=1,console.log("click:"+o),n.publish("endless","love"),t(2,l=l.filter((f,k)=>k!==c)),l.length===0&&(t(0,r=!1),setTimeout(()=>{s.connection.close(),I(),t(1,i="#080101")},100))}return[r,i,l,u,c=>u(c)]}class X extends H{constructor(e){super(),N(this,e,K,G,V,{})}}export{X as default};
