import{k as v,S as U,i as V,s as D,e as g,b as p,m as C,c as y,t as m,o as w,p as T,g as k,q as M,u as j,v as q,w as N,a as Y,x as E,d as L,l as z,y as A,z as G}from"./app-DZRanwQn.js";import{a as H}from"./ably-D_R5ogrI.js";function I(a){const n=a-1;return n*n*n+1}function J(a,{delay:n=0,duration:t=400,easing:e=I,x:r=0,y:s=0,opacity:i=0}={}){const o=getComputedStyle(a),l=+o.opacity,u=o.transform==="none"?"":o.transform,_=l*(1-i),[c,f]=v(r),[d,h]=v(s);return{delay:n,duration:t,easing:e,css:(b,O)=>`
			transform: ${u} translate(${(1-b)*c}${f}, ${(1-b)*d}${h});
			opacity: ${l-_*O}`}}function S(a,n,t){const e=a.slice();return e[8]=n[t],e[10]=t,e}function $(a){let n,t=[],e=new Map,r,s=j(a[2]);const i=o=>o[8].id;for(let o=0;o<s.length;o+=1){let l=S(a,s,o),u=i(l);e.set(u,t[o]=P(u,l))}return{c(){n=g("div");for(let o=0;o<t.length;o+=1)t[o].c();p(n,"class","grid grid-cols-3 gap-10 px-10 py-10")},m(o,l){y(o,n,l);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(n,null);r=!0},p(o,l){l&12&&(s=j(o[2]),q(),t=N(t,l,i,1,o,s,e,n,G,P,null,S),T())},i(o){if(!r){for(let l=0;l<s.length;l+=1)m(t[l]);r=!0}},o(o){for(let l=0;l<t.length;l+=1)w(t[l]);r=!1},d(o){o&&k(n);for(let l=0;l<t.length;l+=1)t[l].d()}}}function P(a,n){let t,e,r,s,i,o,l,u;function _(){return n[4](n[10])}return{key:a,first:null,c(){t=g("div"),e=g("img"),s=Y(),E(e.src,r=n[8].url)||p(e,"src",r),p(e,"alt","Heart"),p(e,"class","w-16"),this.first=t},m(c,f){y(c,t,f),L(t,e),L(t,s),o=!0,l||(u=z(e,"click",_),l=!0)},p(c,f){n=c,(!o||f&4&&!E(e.src,r=n[8].url))&&p(e,"src",r)},i(c){o||(i&&i.end(1),o=!0)},o(c){c&&(i=A(t,J,{y:-200,duration:500})),o=!1},d(c){c&&k(t),c&&i&&i.end(),l=!1,u()}}}function R(a){let n,t,e=a[0]&&$(a);return{c(){n=g("main"),e&&e.c(),p(n,"class","relative w-screen h-screen overflow-hidden flex justify-center items-center"),C(n,"background-color",a[1])},m(r,s){y(r,n,s),e&&e.m(n,null),t=!0},p(r,[s]){r[0]?e?(e.p(r,s),s&1&&m(e,1)):(e=$(r),e.c(),m(e,1),e.m(n,null)):e&&(q(),w(e,1,1,()=>{e=null}),T()),(!t||s&2)&&C(n,"background-color",r[1])},i(r){t||(m(e),t=!0)},o(r){w(e),t=!1},d(r){r&&k(n),e&&e.d()}}}async function x(){try{const a=await fetch("/api/updatelove",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!a.ok)throw new Error("Network response was not ok");const n=await a.json();console.log("Love count updated:",n)}catch(a){console.error("Error updating love count:",a)}}function B(a,n,t){let e=!0,r=0,s="#080101",i,o;M(()=>{let c="G-VP97YYDPP0";window.dataLayer=window.dataLayer||[];function f(...h){window.dataLayer.push(h)}f("js",new Date),f("config",c);const d=document.createElement("script");d.src=`https://www.googletagmanager.com/gtm.js?id=${c}`,document.head.append(d),i=new H.Realtime({authUrl:"/ablyauth"}),i.connection.once("connected",()=>{o=i.channels.get("get-started"),fetch("/api/kolown_bot")}),i.connection.on("failed",h=>{console.error("Connection failed:",h)}),alert("click the hearts to interact with the installation"),t(0,e=!0)});let l=Array(10).fill(null).map((c,f)=>({id:f,url:"https://kolown.net/assets/gitm/heart.svg"}));async function u(c){r+=1,console.log("click:"+r),o.publish("endless","love"),t(2,l=l.filter((f,d)=>d!==c)),l.length===0&&(t(0,e=!1),setTimeout(()=>{i.connection.close(),x(),t(1,s="#080101"),window.location.href="/"},100))}return[e,s,l,u,c=>u(c)]}class Q extends U{constructor(n){super(),V(this,n,B,R,D,{})}}export{Q as default};
